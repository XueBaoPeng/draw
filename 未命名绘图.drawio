<mxfile host="app.diagrams.net" modified="2020-11-22T15:21:16.455Z" agent="5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.25 Safari/537.36 Core/1.70.3776.400 QQBrowser/10.6.4212.400" etag="blAEKy3Vt-uz40itaIkz" version="13.6.2" type="github">
  <diagram id="2N0sheNlyW3y-NobzQPK" name="第 1 页">
    <mxGraphModel dx="998" dy="556" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-1" target="1ufMS89c5Ee1v1FOWZT0-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-1" value="&lt;font style=&quot;font-size: 18px&quot;&gt;扫盲&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="90" y="100" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-3" target="1ufMS89c5Ee1v1FOWZT0-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-3" value="什么是锁" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="270" y="100" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-4" target="1ufMS89c5Ee1v1FOWZT0-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-4" value="分布式锁&lt;br&gt;JVM锁&lt;br&gt;区别" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="460" y="100" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-10" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-5" target="1ufMS89c5Ee1v1FOWZT0-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-5" value="mysql&lt;br&gt;redis&lt;br&gt;zk&lt;br&gt;etcd" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="650" y="100" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-9" value="轻量级的分布式锁" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="850" y="100" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-11" value="锁是什么" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="240" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-12" target="1ufMS89c5Ee1v1FOWZT0-19">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-39" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-12" target="1ufMS89c5Ee1v1FOWZT0-38">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="300" y="440" />
              <mxPoint x="950" y="440" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-40" value="抢到了这把锁" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="1ufMS89c5Ee1v1FOWZT0-39">
          <mxGeometry x="0.2711" y="-3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-12" value="线程" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="240" y="260" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-42" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-13" target="1ufMS89c5Ee1v1FOWZT0-19">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="300" y="340" />
              <mxPoint x="480" y="340" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-13" value="线程" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="240" y="400" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-15" value="堆" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="470" y="290" width="240" height="110" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-35" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-16" target="1ufMS89c5Ee1v1FOWZT0-32">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-16" value="线程" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="240" y="520" width="130" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-36" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.593;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-17" target="1ufMS89c5Ee1v1FOWZT0-32">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-17" value="线程" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="240" y="660" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-18" value="堆" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="510" y="550" width="235" height="100" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-23" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=none;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-19" target="1ufMS89c5Ee1v1FOWZT0-20">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-24" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-19" target="1ufMS89c5Ee1v1FOWZT0-20">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="800" y="240" />
              <mxPoint x="800" y="350" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-19" value="对象头&lt;br&gt;第三方" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="480" y="230" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-20" value="mysql&lt;br&gt;redis" style="ellipse;whiteSpace=wrap;html=1;fillColor=#60a917;strokeColor=#2D7600;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="860" y="310" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-31" value="高并发" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="60" y="354" width="120" height="396" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-37" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-32" target="1ufMS89c5Ee1v1FOWZT0-20">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-32" value="对象头&lt;br&gt;第三方" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="490" y="500" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-51" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-38" target="1ufMS89c5Ee1v1FOWZT0-50">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-38" value="obj&amp;nbsp;&lt;br&gt;&lt;br&gt;data" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="890" y="520" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-41" value="分布式肯定要比单机慢" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="30" y="354" width="260" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-43" value="在有分布式的情况下&lt;br&gt;能保证多机，多线程，多进程访问资源的一致性&lt;br&gt;这个时候还需要进程内部的jvm锁吗？&lt;br&gt;一定需要的！" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="440" y="450" width="300" height="70" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-44" value="一把锁&lt;br&gt;性能有提高吗？&lt;br&gt;用锁，串行化处理" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1060" y="470" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-45" value="多把锁&lt;br&gt;会有并行提升&lt;br&gt;在多机的情况下" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1080" y="590" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-50" value="服务无状态" style="shape=document;whiteSpace=wrap;html=1;boundedLbl=1;" vertex="1" parent="1">
          <mxGeometry x="890" y="660" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-52" value="中间件有&lt;br&gt;IO吞吐&lt;br&gt;有效操作&lt;br&gt;性能" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="830" y="210" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-63" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-53" target="1ufMS89c5Ee1v1FOWZT0-62">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-66" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-53" target="1ufMS89c5Ee1v1FOWZT0-64">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-53" value="俩大类分布式锁" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e3c800;strokeColor=#B09500;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="70" y="820" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-58" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-57" target="1ufMS89c5Ee1v1FOWZT0-59">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="640" y="880" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-57" value="jvm锁&lt;br&gt;cas ,自旋-》系统调用" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="530" y="730" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-61" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-59" target="1ufMS89c5Ee1v1FOWZT0-60">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-59" value="系统调用，后果" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;" vertex="1" parent="1">
          <mxGeometry x="660" y="830" width="80" height="100" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-60" value="线程还运行吗？让出cpu,自己阻塞&lt;br&gt;线程的状态？&lt;br&gt;后续如何运行？自己写醒，还是被唤醒？运行等待内核调度，调度你就可以执行了" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;" vertex="1" parent="1">
          <mxGeometry x="820" y="830" width="240" height="100" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-62" value="&lt;span&gt;类cas自选式的分布式询问的方式，尝试加锁&lt;br&gt;&lt;b&gt;mysql&lt;br&gt;redis&lt;/b&gt;&lt;br&gt;&lt;/span&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;gradientColor=#ffa500;fillColor=#ffcd28;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="250" y="740" width="230" height="100" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-64" value="event事件通知后续锁的变化&lt;br&gt;轮询向外的过程&lt;br&gt;&lt;b&gt;zookeeper&lt;br&gt;etcd&lt;/b&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;gradientColor=#ffa500;fillColor=#ffcd28;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="230" y="900" width="225" height="100" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-70" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-68" target="1ufMS89c5Ee1v1FOWZT0-69">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-68" value="consumer" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="510" y="970" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-69" value="provider" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="850" y="990" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-71" value="consumer" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="520" y="980" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-72" value="consumer" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="530" y="990" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-73" value="consumer" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="540" y="1000" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-75" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-74" target="1ufMS89c5Ee1v1FOWZT0-69">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-74" value="consumer" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="550" y="1010" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-76" value="系统调用&lt;br&gt;网络IO" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e3c800;strokeColor=#B09500;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="700" y="990" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-77" value="&lt;font style=&quot;font-size: 18px&quot;&gt;redis&lt;/font&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#f0a30a;strokeColor=#BD7000;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="20" y="1630" width="80" height="100" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-95" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.442;entryY=0.059;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-78" target="1ufMS89c5Ee1v1FOWZT0-90">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-78" value="&lt;b&gt;&lt;font style=&quot;font-size: 14px&quot;&gt;woker&lt;br&gt;单线程的&lt;br&gt;串行的&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt;发布订阅，阻塞队列+超时（c+redis一起做超时）&lt;/font&gt;&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="610" y="1200" width="370" height="90" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-81" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-79" target="1ufMS89c5Ee1v1FOWZT0-78">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-82" value="如果存在锁，处理完会删除&lt;br&gt;别的自旋的就有几乎抢锁成功" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="1ufMS89c5Ee1v1FOWZT0-81">
          <mxGeometry x="-0.3329" y="-12" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-79" value="c1" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="280" y="1150" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-83" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-80">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="580" y="1250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-84" value="自旋抢锁" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="1ufMS89c5Ee1v1FOWZT0-83">
          <mxGeometry x="-0.3707" y="3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-80" value="c2" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="280" y="1290" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-96" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-85" target="1ufMS89c5Ee1v1FOWZT0-88">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-97" value="加超时" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="1ufMS89c5Ee1v1FOWZT0-96">
          <mxGeometry x="-0.18" y="-18" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-85" value="监控" style="shape=cross;whiteSpace=wrap;html=1;fillColor=#b0e3e6;strokeColor=#0e8088;" vertex="1" parent="1">
          <mxGeometry x="230" y="1040" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-86" value="c2" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="665" y="1310" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-87" value="c1" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="810" y="1310" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-88" value="&lt;b style=&quot;font-size: 19px&quot;&gt;&lt;font color=&quot;#ff3333&quot; style=&quot;font-size: 19px&quot;&gt;本地方法&lt;br&gt;setnx+timeout&lt;/font&gt;&lt;/b&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;" vertex="1" parent="1">
          <mxGeometry x="730" y="1090" width="175" height="100" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-89" value="锁" style="shape=switch;whiteSpace=wrap;html=1;fillColor=#e3c800;strokeColor=#B09500;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="290" y="1130" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-90" value="&lt;b style=&quot;font-size: 13px&quot;&gt;1.如果c1运行一段时间挂了，死锁&lt;br&gt;2.c2要做什么，当c1拿到锁后？通过io发送setnxz执行，做自旋--！！&lt;br&gt;2-1，&lt;/b&gt;&lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt;发布订阅，阻塞队列+超时（c+redis一起做超时）&lt;br&gt;&lt;/font&gt;&lt;/b&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;3.没有挂，但是执行的时间超出了timeout，开辟线程增加timeout&lt;br&gt;&lt;div&gt;&lt;b&gt;4.锁上加标识 UUID方式&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;5.redis会挂&lt;/b&gt;&lt;/div&gt;&lt;/b&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;size=10;align=left;gradientColor=#ffd966;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="580" y="1440" width="430" height="170" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-91" value="c2" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="290" y="1300" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-92" value="c2" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="300" y="1310" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-93" value="c2" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="310" y="1320" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-94" value="复杂度上升了" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fad7ac;strokeColor=#b46504;" vertex="1" parent="1">
          <mxGeometry x="470" y="1120" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-98" value="C2" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="210" y="1640" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-99" value="c1" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="290" y="1640" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-105" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-100" target="1ufMS89c5Ee1v1FOWZT0-103">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="645" y="1720" />
              <mxPoint x="645" y="1675" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-106" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-100" target="1ufMS89c5Ee1v1FOWZT0-104">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-100" value="redis集群" style="rounded=0;whiteSpace=wrap;html=1;gradientColor=#97d077;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="490" y="1700" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-108" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-103" target="1ufMS89c5Ee1v1FOWZT0-107">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-103" value="主从复制" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="680" y="1660" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-112" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-104" target="1ufMS89c5Ee1v1FOWZT0-111">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-104" value="cluser模式" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="680" y="1780" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-110" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-107" target="1ufMS89c5Ee1v1FOWZT0-109">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-107" value="HA&lt;br&gt;单点故障&lt;br&gt;哨兵监控&lt;br&gt;切换主从&lt;br&gt;其他的从追随新的主" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="890" y="1654" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-115" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-109" target="1ufMS89c5Ee1v1FOWZT0-113">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-119" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-109" target="1ufMS89c5Ee1v1FOWZT0-118">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-109" value="数据同步&lt;br&gt;节点间数据是全量的" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1140" y="1670" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-114" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-111" target="1ufMS89c5Ee1v1FOWZT0-113">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-111" value="分治，分片的解决&lt;br&gt;容量，压力，瓶颈" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="880" y="1780" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-117" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-113" target="1ufMS89c5Ee1v1FOWZT0-116">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-113" value="每一个节点存储的是部分数据" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1140" y="1780" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-116" value="锁就是一个key，不同的锁访问不同的节点，不要认为cluster模式节点多就可靠" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1340" y="1780" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-121" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-118" target="1ufMS89c5Ee1v1FOWZT0-120">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-123" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-118" target="1ufMS89c5Ee1v1FOWZT0-122">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-118" value="AP&lt;br&gt;可用性&lt;br&gt;同步不精准" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1340" y="1670" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-120" value="CAP理论" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1460" y="1580" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-125" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-122" target="1ufMS89c5Ee1v1FOWZT0-124">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-127" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-122" target="1ufMS89c5Ee1v1FOWZT0-126">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-122" value="&lt;b&gt;大厂&amp;nbsp;tradoff&lt;br&gt;分布式锁就是用的一台redis实例&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1634" y="1670" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-124" value="&lt;b&gt;1业务剥离，多部署redis&lt;br&gt;2.运维，真服务器，多电源，多网卡，保证不会挂，&lt;br&gt;3.忽略拜占庭问题，有成本&lt;/b&gt;" style="whiteSpace=wrap;html=1;rounded=0;align=left;" vertex="1" parent="1">
          <mxGeometry x="1650" y="1430" width="236" height="140" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-126" value="&lt;b&gt;分布式要在同一个物理的数据中心完成&lt;br&gt;1.redis性能，同主机和其它进程中 10w以上&lt;br&gt;2.同一物理局域网性能 4w&lt;br&gt;3.NAT,云主机，调到白，千&amp;nbsp;的tps，网络的损耗很大&lt;/b&gt;" style="whiteSpace=wrap;html=1;rounded=0;align=left;" vertex="1" parent="1">
          <mxGeometry x="2020" y="1380" width="250" height="170" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-128" value="&lt;b&gt;&lt;font style=&quot;font-size: 24px&quot; color=&quot;#ff3333&quot;&gt;redlock&lt;/font&gt;&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="290" y="1960" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-152" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF3333;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-129" target="1ufMS89c5Ee1v1FOWZT0-151">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-129" value="场景&lt;br&gt;1.redis单机挂了&lt;br&gt;2,redlock,多机&lt;br&gt;3.不是redis实现，是client实现的算法" style="rounded=0;whiteSpace=wrap;html=1;gradientColor=#ffd966;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="490" y="1930" width="260" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-139" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-130" target="1ufMS89c5Ee1v1FOWZT0-136">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-140" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeColor=#FF3333;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-130" target="1ufMS89c5Ee1v1FOWZT0-137">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="710" y="2108" />
              <mxPoint x="710" y="2270" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-141" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-130" target="1ufMS89c5Ee1v1FOWZT0-138">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="830" y="2108" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-130" value="c1" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="480" y="2068" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-142" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF3333;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-131" target="1ufMS89c5Ee1v1FOWZT0-136">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-143" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-131" target="1ufMS89c5Ee1v1FOWZT0-137">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="680" y="2220" />
              <mxPoint x="680" y="2270" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-144" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-131" target="1ufMS89c5Ee1v1FOWZT0-138">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="520" y="2300" />
              <mxPoint x="865" y="2300" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-131" value="c2" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="480" y="2180" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-145" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-132" target="1ufMS89c5Ee1v1FOWZT0-136">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="520" y="2260" />
              <mxPoint x="850" y="2260" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-146" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-132" target="1ufMS89c5Ee1v1FOWZT0-137">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="520" y="2320" />
              <mxPoint x="865" y="2320" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-147" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-132" target="1ufMS89c5Ee1v1FOWZT0-138">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="680" y="2370" />
              <mxPoint x="680" y="2410" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-132" value="c3" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="480" y="2330" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-133" value="r1计数" style="triangle;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="420" y="2080" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-134" value="r1计数" style="triangle;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="420" y="2190" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-135" value="r1计数" style="triangle;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="420" y="2330" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-136" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="810" y="2068" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-137" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="890" y="2200" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-138" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="850" y="2370" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-148" value="随机try" style="rounded=0;whiteSpace=wrap;html=1;gradientColor=#ffd966;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="282.5" y="2068" width="120" height="352" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-149" value="锁" style="shape=switch;whiteSpace=wrap;html=1;gradientColor=#ffd966;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="490" y="2038" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-150" value="&lt;b style=&quot;font-size: 13px&quot;&gt;1.如果c1运行一段时间挂了，死锁&lt;br&gt;2.c2要做什么，当c1拿到锁后？通过io发送setnxz执行，做自旋--！！&lt;br&gt;2-1，&lt;/b&gt;&lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt;发布订阅，阻塞队列+超时（c+redis一起做超时）&lt;br&gt;&lt;/font&gt;&lt;/b&gt;&lt;b style=&quot;font-size: 13px&quot;&gt;3.没有挂，但是执行的时间超出了timeout，开辟线程增加timeout&lt;br&gt;&lt;div&gt;&lt;b&gt;4.锁上加标识 UUID方式&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;5.redis会挂&lt;/b&gt;&lt;/div&gt;&lt;/b&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;size=10;align=left;gradientColor=#ffd966;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1030" y="2220" width="430" height="170" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-151" value="只要过半就可以获得锁&lt;br&gt;抢到一个就可以获得锁&lt;br&gt;timeout" style="whiteSpace=wrap;html=1;rounded=0;strokeColor=#d6b656;fillColor=#fff2cc;gradientColor=#ffd966;" vertex="1" parent="1">
          <mxGeometry x="920" y="1930" width="320" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-153" value="&lt;span style=&quot;font-size: 18px&quot;&gt;zookeeper&lt;br&gt;etcd&lt;br&gt;&lt;/span&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#f0a30a;strokeColor=#BD7000;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="60" y="2650" width="140" height="100" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-164" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-157" target="1ufMS89c5Ee1v1FOWZT0-159">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-165" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-157" target="1ufMS89c5Ee1v1FOWZT0-158">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-157" value="leader" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="500" y="2640" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-158" value="foller" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="340" y="2800" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-159" value="foller" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="630" y="2800" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-160" value="&lt;b&gt;分布式协调：&lt;br&gt;分布式锁&lt;br&gt;分布式ID&lt;br&gt;分布式配置&lt;br&gt;分布式注册发现&lt;br&gt;分布式HA&lt;/b&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;gradientColor=#ffa500;fillColor=#ffcd28;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="780" y="2560" width="190" height="100" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-163" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF3333;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-161" target="1ufMS89c5Ee1v1FOWZT0-157">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-161" value="c1" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="300" y="2570" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-162" value="&lt;br&gt;ledder单机的&lt;br&gt;俩段提交&lt;br&gt;过半通过&lt;br&gt;性能低于redis" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;size=16;gradientColor=#ffa500;fillColor=#ffcd28;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="450" y="2760" width="170" height="120" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-166" value="&lt;b&gt;选举：&lt;br&gt;推让制&lt;br&gt;互相发消息，带着自己的数据id，&amp;nbsp;zxid ，serverid&lt;/b&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;" vertex="1" parent="1">
          <mxGeometry x="929" y="2710" width="240" height="100" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-167" value="session&lt;br&gt;&lt;br&gt;path node&amp;nbsp;&lt;br&gt;2大类&lt;br&gt;持久的&lt;br&gt;临时的node，绑定session&lt;br&gt;&lt;br&gt;&lt;br&gt;watch&amp;nbsp;监控回调" style="rounded=0;whiteSpace=wrap;html=1;gradientColor=#ffd966;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="960" y="2830" width="180" height="180" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-182" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#000000;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-168" target="1ufMS89c5Ee1v1FOWZT0-181">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-187" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.425;entryY=0.918;entryDx=0;entryDy=0;entryPerimeter=0;strokeColor=#FF3333;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-168" target="1ufMS89c5Ee1v1FOWZT0-179">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="570" y="3023" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-168" value="临时的&lt;br&gt;/outxxLock*" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="500" y="2890" width="140" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-184" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#000000;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-172" target="1ufMS89c5Ee1v1FOWZT0-168">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="440" y="2680" />
              <mxPoint x="440" y="2930" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-172" value="监控回调FC" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="290" y="2640" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-186" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#000000;" edge="1" parent="1" source="1ufMS89c5Ee1v1FOWZT0-179" target="1ufMS89c5Ee1v1FOWZT0-168">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-179" value="监控回调FC" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="260" y="2950" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-181" value="DELETE&lt;br&gt;CREATE&lt;br&gt;CHANGE" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="730" y="2960" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1ufMS89c5Ee1v1FOWZT0-183" value="c2" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="260" y="2870" width="80" height="80" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
